[![Build Status](https://travis-ci.org/epogrebnyak/data-rosstat-kep.svg?branch=dev)](https://travis-ci.org/epogrebnyak/data-rosstat-kep)

Псеводкод
=========
```python

class DataRelease(year):
  # INPUTS
  # locate csv file based on year
  # stream csv rows
  # read and accept parsing definition ('pdef')
  
  # PARSING
  # split csv rows to tables using pdef
  # parse table headers
  # print parsing result
  # parse datapoints in table
  
  # EMITTING
  # emit datapoints
  # make 3 dataframes
```

Краткое описание модуля парсинга 
================================

Подготовительная работа вне модуля:

- zip/rar архив с файлами word преобразован в csv 

На входе: 

- tab.csv (сроки заголовков + строки данных)
- speс.yaml (заголовки -> названия переменных)

Конечный результат: 

- поток данных (название переменной, частота, дата, значение), где частота - год, месяц или квартал

Этапы реалиазции:

- получить tab.csv в виде потока строк 
- получить speс.yaml в виде объекта ParsingDefinition
- разбить tab.csv на таблицы, таблица состоит из двух групп строк: (строки заголовков, строки данных)
- определить название переменной для каждой таблицы с помощью ParsingDefinition (парсинг)
- выдать статистику результативности парсинга
- разобрать таблицу на точки данных (частота, дата, значение) 
- выдать поток данных (название переменной, частота, дата, значение)
- сформировать три датафрейма данных (год, квартал, месяц)

Ограничения:

- один speс.yaml, но удобнее если их несколько (сейчас несколько определений разбросаны по разным файлам из-за удобства)
- не все таблицы можно отпарсить с помощью одного ParsingDefinition из-за повторящихся заголовков 
- не все таблицы можно отпарсить с помощью одного ParsingDefinition из-за кастом функций  для ридера (случай fiscal)

Дальнейшее использование
========================

- markdown-таблица с названиями переменных и последним значением 
- ...

Структура каталога 
==================
```
update.py
revisions.py
README.md
kep
 config.py 
 .word2csv
 .inputs
 .parser 
data
- YYYY
  - MM
   - ...
output
- csv
- xls
- img
  - sparks
  - png
```

Архив
=====

О структуре проекта: <https://github.com/epogrebnyak/data-rosstat-kep/issues/135>

Текущие задачи: <https://github.com/epogrebnyak/data-rosstat-kep/issues/136>

Итоговые задачи
===============

Текущее:

- показать витрину имеющихся данных с последними значениями
- проиллюстрировать пересмотры предыдущей статистики ВВП, промпроизводства и товарооборота (revisions.py)

Перспективные:

- протестировать свойства показателей, снять сезонность с рядов выпуска продукции и перевозок (в R seasonality)
- проиллюстрировать длиннные парные ряды переменных (Business Conditions)
- вероятность нахождения в рецессии
- воспроизвести расчет NPV+факторы
- скомбинировать показатели инфляции

Вспомогательные:

- расширить исторические данные 
- завести данные по нефти и курсу 
