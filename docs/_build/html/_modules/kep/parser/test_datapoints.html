<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>kep.parser.test_datapoints &#8212; kep  documentation</title>
    
    <link rel="stylesheet" href="../../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for kep.parser.test_datapoints</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">unittest</span> 

<span class="kn">from</span> <span class="nn">kep.parser.emitter</span> <span class="k">import</span> <span class="n">Datapoints</span>
<span class="kn">from</span> <span class="nn">kep.reader.parsing_definitions</span> <span class="k">import</span> <span class="n">ParsingDefinition</span>
<span class="kn">from</span> <span class="nn">kep.reader.csv_data</span> <span class="k">import</span> <span class="n">CSV_Reader</span>
<span class="kn">from</span> <span class="nn">kep.reader.files</span> <span class="k">import</span> <span class="n">Tempfile</span>
	

<span class="c1">#</span>
<span class="c1"># Fixtures - test strings</span>
<span class="c1">#</span>

<span class="c1"># ---------------- CSV data</span>

<span class="n">csv_content_1</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">	Год / Year	Кварталы / Quarters			</span>
<span class="s2">		I	II	III	IV</span>
<span class="s2">1. Сводные показатели / Aggregated indicators					</span>
<span class="s2">1.1. Валовой внутренний продукт1) / Gross domestic product1)					</span>
<span class="s2">Объем ВВП, млрд.рублей /GDP, bln rubles					</span>
<span class="s2">2013	71017	15892	17015	18543	19567</span>
<span class="s2">20142)	79200	17139	18884	20407	21515</span>
<span class="s2">20152)	83233	18210	19284	21294	22016</span>
<span class="s2">20162)	85881	18561	19979	22190	</span>
<span class="s2">2017					</span>
<span class="s2">Индекс физического объема произведенного ВВП, в % / Volume index of produced GDP, percent					</span>
<span class="s2">2013	101,3	100,6	101,1	101,2	102,1</span>
<span class="s2">20142)	100,7	100,6	101,1	100,9	100,2</span>
<span class="s2">20152)	97,2	97,2	95,5	96,3	96,2</span>
<span class="s2">20162)	99,8	98,8	99,4	99,6	</span>
<span class="s2">2017					</span>
<span class="s2">&quot;&quot;&quot;</span>


<span class="n">csv_content_2</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">	Год / Year	Кварталы / Quarters	Янв. Jan.	Фев. Feb.	Март Mar.	Апр. Apr.	Май May	Июнь June	Июль July	Август Aug.	Сент. Sept.	Окт. Oct.	Нояб. Nov.	Дек. Dec.			</span>
<span class="s2">		I	II	III	IV												</span>
<span class="s2">1.2. Индекс промышленного производства1) / Industrial Production index1)																	</span>
<span class="s2">в % к соответствующему периоду предыдущего года / percent of corresponding period of previous year																	</span>
<span class="s2">2015	99,2	99,9	98,3	99,5	99,1	100,0	98,2	101,2	98,2	97,6	99,1	98,5	100,2	99,7	98,4	101,0	98,1</span>
<span class="s2">2016	101,3	101,1	101,5	101,0	101,7	99,2	103,8	100,3	101,0	101,5	102,0	101,4	101,5	100,1	101,6	103,4	100,2</span>
<span class="s2">2017						102,3	97,3										</span>
<span class="s2">в % к предыдущему периоду / percent of previous period																	</span>
<span class="s2">2015		82,8	102,6	103,9	112,3	73,9	99,8	112,5	95,6	97,6	103,2	100,5	101,4	103,1	105,0	101,9	109,1</span>
<span class="s2">2016		84,4	103,1	103,3	113,1	74,7	104,4	108,8	96,3	98,1	103,8	99,9	101,5	101,7	106,6	103,6	105,8</span>
<span class="s2">2017						76,2	99,4										</span>
<span class="s2">период с начала отчетного года в % к соответствующему периоду предыдущего года / period from beginning of reporting year as percent of corresponding period of previous year																	</span>
<span class="s2">2015						100,0	99,1	99,9	99,4	99,1	99,1	99,0	99,1	99,2	99,1	99,3	99,2</span>
<span class="s2">2016						99,2	101,5	101,1	101,1	101,1	101,3	101,3	101,3	101,2	101,2	101,4	101,3</span>
<span class="s2">2017						102,3	99,7										</span>
<span class="s2">&quot;&quot;&quot;</span>


<span class="n">csv_content_3</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">	Год Year	Янв. Jan.	Янв-фев. Jan-Feb	I квартал Q1	Янв-апр. Jan-Apr	Янв-май Jan-May	I полугод. 1st half year	Янв-июль Jan-Jul	Янв-авг. Jan-Aug	Янв-cент. Jan-Sent	Янв-окт. Jan-Oct	Янв-нояб. Jan-Nov</span>
<span class="s2">2. Финансы / Finances												</span>
<span class="s2">2.1. Доходы и расходы / Revenues and expenditures												</span>
<span class="s2">2.1.1. Доходы (по данным Федерального казначейства)1) / Revenues (data of the Federal Treasury)1)												</span>
<span class="s2">Консолидированный бюджет, млрд.рублей / Consolidated budget, bln rubles												</span>
<span class="s2">2013	24442,7	1591,7	3206,6	5401,6	7707,7	9441,5	11370,7	13574,9	15472,1	17417,5	19700,9	21570,2</span>
<span class="s2">20142)	26766,1	1726,3	3579,8	5960,4	8498,3	10572,3	12671,2	15108,2	17143,4	19221,4	21563,5	23439,4</span>
<span class="s2">2015	26922,0	1661,5	3403,0	6044,6	8704,9	10514,7	12748,6	15243,3	17316,8	19496,2	21911,1	23679,2</span>
<span class="s2">2016	27746,73)	1653,1	3264,7	5876,1	8330,0	10213,0	12521,5	14932,9	17197,8	19374,5	21871,0	24095,8</span>
<span class="s2">2017		1978,8										</span>
<span class="s2">	Год Year	Янв. Jan.	Янв-фев. Jan-Feb	I квартал Q1	Янв-апр. Jan-Apr	Янв-май Jan-May	I полугод. 1st I half year	Янв-июль Jan-Jul	Янв-авг. Jan-Aug	Янв-cент. Jan-Sent	Янв-окт. Jan-Oct	Янв-нояб. Jan-Nov</span>
<span class="s2">Удельный вес в общем объеме доходов соответствующего бюджета, в процентах / Share of revenue of corresponding budget in total revenues, percent												</span>
<span class="s2">&quot;&quot;&quot;</span>


<span class="c1"># ---------------- parsing definitions (YAML) data</span>
                                       
<span class="n">yaml_content_1</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2"># Раздел 1. Информация по сегментам</span>
<span class="s2"># Section 1. Segment information </span>
<span class="s2"># segment information</span>
<span class="s2">start line : null</span>
<span class="s2">end line : null</span>
<span class="s2">special reader: null</span>
<span class="s2">---</span>
<span class="s2"># Раздел 2. Единицы измерении</span>
<span class="s2"># Section 2. Units of measurement</span>
<span class="s2"># rog - темп изменения к предыдущему периоду  </span>
<span class="s2"># yoy - темп изменения к соответствующему периоду предыдущего года  </span>
<span class="s2"># ytd - темп изменения за период с начала текущегогода к аппп</span>
<span class="s2">в % к предыдущему периоду : rog</span>
<span class="s2">период с начала отчетного года в % к соответствующему периоду предыдущего года : ytd</span>
<span class="s2">в % к соответствующему периоду предыдущего года : yoy</span>
<span class="s2">---</span>
<span class="s2">#2. Финансы / Finances</span>
<span class="s2">#2.1. Доходы и расходы 1) / Revenues and expenditures 1)</span>
<span class="s2">#2.1.1. Доходы (по данным Федерального казначейства) 2) / Revenues (data of the Federal Treasury) 2)</span>
<span class="s2">#Консолидированный бюджет, млрд.рублей / Consolidated budget, bln rubles</span>
<span class="s2">Объем ВВП : </span>
<span class="s2"> - GDP</span>
<span class="s2"> - bln_rub</span>
<span class="s2">Индекс физического объема произведенного ВВП :</span>
<span class="s2"> - GDP</span>
<span class="s2"> - rog</span>
<span class="s2">Индекс промышленного производства :</span>
<span class="s2"> - IND_PROD </span>
<span class="s2">&quot;&quot;&quot;</span>


<span class="n">yaml_content_2</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2"># Раздел 1. Информация по сегментам</span>
<span class="s2"># Section 1. Segment information </span>
<span class="s2"># segment information</span>
<span class="s2">start line : 2.1.1. Доходы (по данным Федерального казначейства)</span>
<span class="s2">end line : Удельный вес в общем объеме доходов соответствующего бюджета</span>
<span class="s2">special reader: fiscal</span>
<span class="s2">---</span>
<span class="s2"># Раздел 2. Единицы измерении</span>
<span class="s2"># Section 2. Units of measurement</span>
<span class="s2"># rog - темп изменения к предыдущему периоду  </span>
<span class="s2"># yoy - темп изменения к соответствующему периоду предыдущего года  </span>
<span class="s2"># ytd - темп изменения за период с начала текущегогода к аппп</span>
<span class="s2">в % к соответствующему периоду предыдущего года : yoy</span>
<span class="s2">в % к предыдущему периоду : rog</span>
<span class="s2">в % к предыдущему месяцу: rog</span>
<span class="s2">период с начала отчетного года : ytd</span>
<span class="s2">отчетный месяц в % к соответствующему месяцу предыдущего года : yoy</span>
<span class="s2">в % к соответствующему месяцу предыдущего года : yoy</span>
<span class="s2">отчетный месяц в % к предыдущему месяцу : rog </span>
<span class="s2">рублей / rubles : rub</span>
<span class="s2">млн.рублей : mln_rub</span>
<span class="s2">---</span>
<span class="s2">#2. Финансы / Finances</span>
<span class="s2">#2.1. Доходы и расходы 1) / Revenues and expenditures 1)</span>
<span class="s2">#2.1.1. Доходы (по данным Федерального казначейства) 2) / Revenues (data of the Federal Treasury) 2)</span>
<span class="s2">#Консолидированный бюджет, млрд.рублей / Consolidated budget, bln rubles</span>
<span class="s2">Консолидированный бюджет : </span>
<span class="s2"> - GOV_CONSOLIDATED_REVENUE_ACCUM</span>
<span class="s2"> - bln_rub</span>
<span class="s2"> &quot;&quot;&quot;</span>


<div class="viewcode-block" id="get_csv_data"><a class="viewcode-back" href="../../../kep.parser.html#kep.parser.test_datapoints.get_csv_data">[docs]</a><span class="k">def</span> <span class="nf">get_csv_data</span><span class="p">(</span><span class="n">content</span><span class="p">):</span>
     <span class="c1"># get csv data  </span>
     <span class="k">with</span> <span class="n">Tempfile</span><span class="p">(</span><span class="n">content_string</span> <span class="o">=</span> <span class="n">content</span><span class="p">)</span> <span class="k">as</span> <span class="n">path</span><span class="p">:</span>
         <span class="k">return</span> <span class="n">CSV_Reader</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">.</span><span class="n">yield_dicts</span><span class="p">()</span>		</div>
     
    
<div class="viewcode-block" id="get_parsing_def"><a class="viewcode-back" href="../../../kep.parser.html#kep.parser.test_datapoints.get_parsing_def">[docs]</a><span class="k">def</span> <span class="nf">get_parsing_def</span><span class="p">(</span><span class="n">content</span><span class="p">):</span>
     <span class="c1"># get test parsing definitions</span>
     <span class="k">with</span> <span class="n">Tempfile</span><span class="p">(</span><span class="n">content_string</span> <span class="o">=</span> <span class="n">content</span><span class="p">)</span> <span class="k">as</span> <span class="n">path</span><span class="p">:</span>
         <span class="k">return</span> <span class="n">ParsingDefinition</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>	</div>
     
    
<div class="viewcode-block" id="get_dfs"><a class="viewcode-back" href="../../../kep.parser.html#kep.parser.test_datapoints.get_dfs">[docs]</a><span class="k">def</span> <span class="nf">get_dfs</span><span class="p">(</span><span class="n">input_csv</span><span class="p">,</span> <span class="n">yaml_content</span><span class="p">):</span>    
    <span class="c1"># get test parsing definitions</span>
    <span class="n">pdef</span> <span class="o">=</span> <span class="n">get_parsing_def</span><span class="p">(</span><span class="n">yaml_content</span><span class="p">)</span>
	 <span class="c1"># get csv data     </span>
    <span class="n">csv_dicts</span> <span class="o">=</span> <span class="n">get_csv_data</span><span class="p">(</span><span class="n">input_csv</span><span class="p">)</span>                
    <span class="n">d</span> <span class="o">=</span> <span class="n">Datapoints</span><span class="p">(</span><span class="n">csv_dicts</span><span class="p">,</span> <span class="n">pdef</span><span class="p">)</span>    
    <span class="c1"># added column order to match DFA, DFQ, DFM constants</span>
    <span class="n">dfa</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">))[[</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">&#39;varname&#39;</span><span class="p">,</span> <span class="s1">&#39;year&#39;</span><span class="p">]]</span>
    <span class="n">dfq</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="s1">&#39;q&#39;</span><span class="p">))[[</span><span class="s1">&#39;qtr&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">&#39;varname&#39;</span><span class="p">,</span> <span class="s1">&#39;year&#39;</span><span class="p">]]</span>
    <span class="n">dfm</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="s1">&#39;m&#39;</span><span class="p">))[[</span><span class="s1">&#39;month&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">&#39;varname&#39;</span><span class="p">,</span> <span class="s1">&#39;year&#39;</span><span class="p">]]</span>
    <span class="k">return</span> <span class="n">dfa</span><span class="p">,</span> <span class="n">dfq</span><span class="p">,</span> <span class="n">dfm</span>    </div>
    
    
<div class="viewcode-block" id="TestDatapoints"><a class="viewcode-back" href="../../../kep.parser.html#kep.parser.test_datapoints.TestDatapoints">[docs]</a><span class="k">class</span> <span class="nc">TestDatapoints</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    
    <span class="c1"># QUESTION: use setUp() and tearDown() methods here?</span>
    
<div class="viewcode-block" id="TestDatapoints.test_dataframes_simple"><a class="viewcode-back" href="../../../kep.parser.html#kep.parser.test_datapoints.TestDatapoints.test_dataframes_simple">[docs]</a>    <span class="k">def</span> <span class="nf">test_dataframes_simple</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        csv: csv_content_1 + csv_content_2 </span>
<span class="sd">        yaml: yaml_content_1</span>
<span class="sd">        matches: hardcoded values below</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">input_csv</span> <span class="o">=</span> <span class="n">csv_content_1</span> <span class="o">+</span> <span class="n">csv_content_2</span>
        <span class="n">yaml_content</span> <span class="o">=</span> <span class="n">yaml_content_1</span>
        <span class="n">dfa</span><span class="p">,</span> <span class="n">dfq</span><span class="p">,</span> <span class="n">dfm</span> <span class="o">=</span> <span class="n">get_dfs</span><span class="p">(</span><span class="n">input_csv</span><span class="p">,</span> <span class="n">yaml_content</span><span class="p">)</span>
        
        <span class="k">assert</span> <span class="n">dfa</span><span class="o">.</span><span class="n">to_csv</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;,value,varname,year</span><span class="se">\n</span><span class="s1">0,71017.0,GDP_bln_rub,2013</span><span class="se">\n</span><span class="s1">1,79200.0,GDP_bln_rub,2014</span><span class="se">\n</span><span class="s1">2,83233.0,GDP_bln_rub,2015</span><span class="se">\n</span><span class="s1">3,85881.0,GDP_bln_rub,2016</span><span class="se">\n</span><span class="s1">4,101.3,GDP_rog,2013</span><span class="se">\n</span><span class="s1">5,100.7,GDP_rog,2014</span><span class="se">\n</span><span class="s1">6,97.2,GDP_rog,2015</span><span class="se">\n</span><span class="s1">7,99.8,GDP_rog,2016</span><span class="se">\n</span><span class="s1">8,99.2,IND_PROD_yoy,2015</span><span class="se">\n</span><span class="s1">9,101.3,IND_PROD_yoy,2016</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">assert</span> <span class="n">dfq</span><span class="o">.</span><span class="n">to_csv</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;,qtr,value,varname,year</span><span class="se">\n</span><span class="s1">0,1,15892.0,GDP_bln_rub,2013</span><span class="se">\n</span><span class="s1">1,2,17015.0,GDP_bln_rub,2013</span><span class="se">\n</span><span class="s1">2,3,18543.0,GDP_bln_rub,2013</span><span class="se">\n</span><span class="s1">3,4,19567.0,GDP_bln_rub,2013</span><span class="se">\n</span><span class="s1">4,1,17139.0,GDP_bln_rub,2014</span><span class="se">\n</span><span class="s1">5,2,18884.0,GDP_bln_rub,2014</span><span class="se">\n</span><span class="s1">6,3,20407.0,GDP_bln_rub,2014</span><span class="se">\n</span><span class="s1">7,4,21515.0,GDP_bln_rub,2014</span><span class="se">\n</span><span class="s1">8,1,18210.0,GDP_bln_rub,2015</span><span class="se">\n</span><span class="s1">9,2,19284.0,GDP_bln_rub,2015</span><span class="se">\n</span><span class="s1">10,3,21294.0,GDP_bln_rub,2015</span><span class="se">\n</span><span class="s1">11,4,22016.0,GDP_bln_rub,2015</span><span class="se">\n</span><span class="s1">12,1,18561.0,GDP_bln_rub,2016</span><span class="se">\n</span><span class="s1">13,2,19979.0,GDP_bln_rub,2016</span><span class="se">\n</span><span class="s1">14,3,22190.0,GDP_bln_rub,2016</span><span class="se">\n</span><span class="s1">15,1,100.6,GDP_rog,2013</span><span class="se">\n</span><span class="s1">16,2,101.1,GDP_rog,2013</span><span class="se">\n</span><span class="s1">17,3,101.2,GDP_rog,2013</span><span class="se">\n</span><span class="s1">18,4,102.1,GDP_rog,2013</span><span class="se">\n</span><span class="s1">19,1,100.6,GDP_rog,2014</span><span class="se">\n</span><span class="s1">20,2,101.1,GDP_rog,2014</span><span class="se">\n</span><span class="s1">21,3,100.9,GDP_rog,2014</span><span class="se">\n</span><span class="s1">22,4,100.2,GDP_rog,2014</span><span class="se">\n</span><span class="s1">23,1,97.2,GDP_rog,2015</span><span class="se">\n</span><span class="s1">24,2,95.5,GDP_rog,2015</span><span class="se">\n</span><span class="s1">25,3,96.3,GDP_rog,2015</span><span class="se">\n</span><span class="s1">26,4,96.2,GDP_rog,2015</span><span class="se">\n</span><span class="s1">27,1,98.8,GDP_rog,2016</span><span class="se">\n</span><span class="s1">28,2,99.4,GDP_rog,2016</span><span class="se">\n</span><span class="s1">29,3,99.6,GDP_rog,2016</span><span class="se">\n</span><span class="s1">30,1,99.9,IND_PROD_yoy,2015</span><span class="se">\n</span><span class="s1">31,2,98.3,IND_PROD_yoy,2015</span><span class="se">\n</span><span class="s1">32,3,99.5,IND_PROD_yoy,2015</span><span class="se">\n</span><span class="s1">33,4,99.1,IND_PROD_yoy,2015</span><span class="se">\n</span><span class="s1">34,1,101.1,IND_PROD_yoy,2016</span><span class="se">\n</span><span class="s1">35,2,101.5,IND_PROD_yoy,2016</span><span class="se">\n</span><span class="s1">36,3,101.0,IND_PROD_yoy,2016</span><span class="se">\n</span><span class="s1">37,4,101.7,IND_PROD_yoy,2016</span><span class="se">\n</span><span class="s1">38,1,82.8,IND_PROD_rog,2015</span><span class="se">\n</span><span class="s1">39,2,102.6,IND_PROD_rog,2015</span><span class="se">\n</span><span class="s1">40,3,103.9,IND_PROD_rog,2015</span><span class="se">\n</span><span class="s1">41,4,112.3,IND_PROD_rog,2015</span><span class="se">\n</span><span class="s1">42,1,84.4,IND_PROD_rog,2016</span><span class="se">\n</span><span class="s1">43,2,103.1,IND_PROD_rog,2016</span><span class="se">\n</span><span class="s1">44,3,103.3,IND_PROD_rog,2016</span><span class="se">\n</span><span class="s1">45,4,113.1,IND_PROD_rog,2016</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">assert</span> <span class="n">dfm</span><span class="o">.</span><span class="n">to_csv</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;,month,value,varname,year</span><span class="se">\n</span><span class="s1">0,1,100.0,IND_PROD_yoy,2015</span><span class="se">\n</span><span class="s1">1,2,98.2,IND_PROD_yoy,2015</span><span class="se">\n</span><span class="s1">2,3,101.2,IND_PROD_yoy,2015</span><span class="se">\n</span><span class="s1">3,4,98.2,IND_PROD_yoy,2015</span><span class="se">\n</span><span class="s1">4,5,97.6,IND_PROD_yoy,2015</span><span class="se">\n</span><span class="s1">5,6,99.1,IND_PROD_yoy,2015</span><span class="se">\n</span><span class="s1">6,7,98.5,IND_PROD_yoy,2015</span><span class="se">\n</span><span class="s1">7,8,100.2,IND_PROD_yoy,2015</span><span class="se">\n</span><span class="s1">8,9,99.7,IND_PROD_yoy,2015</span><span class="se">\n</span><span class="s1">9,10,98.4,IND_PROD_yoy,2015</span><span class="se">\n</span><span class="s1">10,11,101.0,IND_PROD_yoy,2015</span><span class="se">\n</span><span class="s1">11,12,98.1,IND_PROD_yoy,2015</span><span class="se">\n</span><span class="s1">12,1,99.2,IND_PROD_yoy,2016</span><span class="se">\n</span><span class="s1">13,2,103.8,IND_PROD_yoy,2016</span><span class="se">\n</span><span class="s1">14,3,100.3,IND_PROD_yoy,2016</span><span class="se">\n</span><span class="s1">15,4,101.0,IND_PROD_yoy,2016</span><span class="se">\n</span><span class="s1">16,5,101.5,IND_PROD_yoy,2016</span><span class="se">\n</span><span class="s1">17,6,102.0,IND_PROD_yoy,2016</span><span class="se">\n</span><span class="s1">18,7,101.4,IND_PROD_yoy,2016</span><span class="se">\n</span><span class="s1">19,8,101.5,IND_PROD_yoy,2016</span><span class="se">\n</span><span class="s1">20,9,100.1,IND_PROD_yoy,2016</span><span class="se">\n</span><span class="s1">21,10,101.6,IND_PROD_yoy,2016</span><span class="se">\n</span><span class="s1">22,11,103.4,IND_PROD_yoy,2016</span><span class="se">\n</span><span class="s1">23,12,100.2,IND_PROD_yoy,2016</span><span class="se">\n</span><span class="s1">24,1,102.3,IND_PROD_yoy,2017</span><span class="se">\n</span><span class="s1">25,2,97.3,IND_PROD_yoy,2017</span><span class="se">\n</span><span class="s1">26,1,73.9,IND_PROD_rog,2015</span><span class="se">\n</span><span class="s1">27,2,99.8,IND_PROD_rog,2015</span><span class="se">\n</span><span class="s1">28,3,112.5,IND_PROD_rog,2015</span><span class="se">\n</span><span class="s1">29,4,95.6,IND_PROD_rog,2015</span><span class="se">\n</span><span class="s1">30,5,97.6,IND_PROD_rog,2015</span><span class="se">\n</span><span class="s1">31,6,103.2,IND_PROD_rog,2015</span><span class="se">\n</span><span class="s1">32,7,100.5,IND_PROD_rog,2015</span><span class="se">\n</span><span class="s1">33,8,101.4,IND_PROD_rog,2015</span><span class="se">\n</span><span class="s1">34,9,103.1,IND_PROD_rog,2015</span><span class="se">\n</span><span class="s1">35,10,105.0,IND_PROD_rog,2015</span><span class="se">\n</span><span class="s1">36,11,101.9,IND_PROD_rog,2015</span><span class="se">\n</span><span class="s1">37,12,109.1,IND_PROD_rog,2015</span><span class="se">\n</span><span class="s1">38,1,74.7,IND_PROD_rog,2016</span><span class="se">\n</span><span class="s1">39,2,104.4,IND_PROD_rog,2016</span><span class="se">\n</span><span class="s1">40,3,108.8,IND_PROD_rog,2016</span><span class="se">\n</span><span class="s1">41,4,96.3,IND_PROD_rog,2016</span><span class="se">\n</span><span class="s1">42,5,98.1,IND_PROD_rog,2016</span><span class="se">\n</span><span class="s1">43,6,103.8,IND_PROD_rog,2016</span><span class="se">\n</span><span class="s1">44,7,99.9,IND_PROD_rog,2016</span><span class="se">\n</span><span class="s1">45,8,101.5,IND_PROD_rog,2016</span><span class="se">\n</span><span class="s1">46,9,101.7,IND_PROD_rog,2016</span><span class="se">\n</span><span class="s1">47,10,106.6,IND_PROD_rog,2016</span><span class="se">\n</span><span class="s1">48,11,103.6,IND_PROD_rog,2016</span><span class="se">\n</span><span class="s1">49,12,105.8,IND_PROD_rog,2016</span><span class="se">\n</span><span class="s1">50,1,76.2,IND_PROD_rog,2017</span><span class="se">\n</span><span class="s1">51,2,99.4,IND_PROD_rog,2017</span><span class="se">\n</span><span class="s1">52,1,100.0,IND_PROD_ytd,2015</span><span class="se">\n</span><span class="s1">53,2,99.1,IND_PROD_ytd,2015</span><span class="se">\n</span><span class="s1">54,3,99.9,IND_PROD_ytd,2015</span><span class="se">\n</span><span class="s1">55,4,99.4,IND_PROD_ytd,2015</span><span class="se">\n</span><span class="s1">56,5,99.1,IND_PROD_ytd,2015</span><span class="se">\n</span><span class="s1">57,6,99.1,IND_PROD_ytd,2015</span><span class="se">\n</span><span class="s1">58,7,99.0,IND_PROD_ytd,2015</span><span class="se">\n</span><span class="s1">59,8,99.1,IND_PROD_ytd,2015</span><span class="se">\n</span><span class="s1">60,9,99.2,IND_PROD_ytd,2015</span><span class="se">\n</span><span class="s1">61,10,99.1,IND_PROD_ytd,2015</span><span class="se">\n</span><span class="s1">62,11,99.3,IND_PROD_ytd,2015</span><span class="se">\n</span><span class="s1">63,12,99.2,IND_PROD_ytd,2015</span><span class="se">\n</span><span class="s1">64,1,99.2,IND_PROD_ytd,2016</span><span class="se">\n</span><span class="s1">65,2,101.5,IND_PROD_ytd,2016</span><span class="se">\n</span><span class="s1">66,3,101.1,IND_PROD_ytd,2016</span><span class="se">\n</span><span class="s1">67,4,101.1,IND_PROD_ytd,2016</span><span class="se">\n</span><span class="s1">68,5,101.1,IND_PROD_ytd,2016</span><span class="se">\n</span><span class="s1">69,6,101.3,IND_PROD_ytd,2016</span><span class="se">\n</span><span class="s1">70,7,101.3,IND_PROD_ytd,2016</span><span class="se">\n</span><span class="s1">71,8,101.3,IND_PROD_ytd,2016</span><span class="se">\n</span><span class="s1">72,9,101.2,IND_PROD_ytd,2016</span><span class="se">\n</span><span class="s1">73,10,101.2,IND_PROD_ytd,2016</span><span class="se">\n</span><span class="s1">74,11,101.4,IND_PROD_ytd,2016</span><span class="se">\n</span><span class="s1">75,12,101.3,IND_PROD_ytd,2016</span><span class="se">\n</span><span class="s1">76,1,102.3,IND_PROD_ytd,2017</span><span class="se">\n</span><span class="s1">77,2,99.7,IND_PROD_ytd,2017</span><span class="se">\n</span><span class="s1">&#39;</span>                         </div>
        
<div class="viewcode-block" id="TestDatapoints.test_dataframes_using_custom_splitter_func"><a class="viewcode-back" href="../../../kep.parser.html#kep.parser.test_datapoints.TestDatapoints.test_dataframes_using_custom_splitter_func">[docs]</a>    <span class="k">def</span> <span class="nf">test_dataframes_using_custom_splitter_func</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        csv: csv_content_3 </span>
<span class="sd">        yaml: yaml_content_2</span>
<span class="sd">        matches: hardcoded values below</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">input_csv</span> <span class="o">=</span> <span class="n">csv_content_3</span>
        <span class="n">yaml_content</span> <span class="o">=</span> <span class="n">yaml_content_2</span>
        <span class="n">dfa</span><span class="p">,</span> <span class="n">dfq</span><span class="p">,</span> <span class="n">dfm</span> <span class="o">=</span> <span class="n">get_dfs</span><span class="p">(</span><span class="n">input_csv</span><span class="p">,</span> <span class="n">yaml_content</span><span class="p">)</span>
        
        <span class="k">assert</span> <span class="n">dfa</span><span class="o">.</span><span class="n">to_csv</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;,value,varname,year</span><span class="se">\n</span><span class="s1">0,24442.7,GOV_CONSOLIDATED_REVENUE_ACCUM_bln_rub,2013</span><span class="se">\n</span><span class="s1">1,26766.1,GOV_CONSOLIDATED_REVENUE_ACCUM_bln_rub,2014</span><span class="se">\n</span><span class="s1">2,26922.0,GOV_CONSOLIDATED_REVENUE_ACCUM_bln_rub,2015</span><span class="se">\n</span><span class="s1">3,27746.7,GOV_CONSOLIDATED_REVENUE_ACCUM_bln_rub,2016</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">assert</span> <span class="n">dfq</span><span class="o">.</span><span class="n">to_csv</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;,qtr,value,varname,year</span><span class="se">\n</span><span class="s1">0,1,5401.6,GOV_CONSOLIDATED_REVENUE_ACCUM_bln_rub,2013</span><span class="se">\n</span><span class="s1">1,2,11370.7,GOV_CONSOLIDATED_REVENUE_ACCUM_bln_rub,2013</span><span class="se">\n</span><span class="s1">2,3,17417.5,GOV_CONSOLIDATED_REVENUE_ACCUM_bln_rub,2013</span><span class="se">\n</span><span class="s1">3,4,24442.7,GOV_CONSOLIDATED_REVENUE_ACCUM_bln_rub,2013</span><span class="se">\n</span><span class="s1">4,1,5960.4,GOV_CONSOLIDATED_REVENUE_ACCUM_bln_rub,2014</span><span class="se">\n</span><span class="s1">5,2,12671.2,GOV_CONSOLIDATED_REVENUE_ACCUM_bln_rub,2014</span><span class="se">\n</span><span class="s1">6,3,19221.4,GOV_CONSOLIDATED_REVENUE_ACCUM_bln_rub,2014</span><span class="se">\n</span><span class="s1">7,4,26766.1,GOV_CONSOLIDATED_REVENUE_ACCUM_bln_rub,2014</span><span class="se">\n</span><span class="s1">8,1,6044.6,GOV_CONSOLIDATED_REVENUE_ACCUM_bln_rub,2015</span><span class="se">\n</span><span class="s1">9,2,12748.6,GOV_CONSOLIDATED_REVENUE_ACCUM_bln_rub,2015</span><span class="se">\n</span><span class="s1">10,3,19496.2,GOV_CONSOLIDATED_REVENUE_ACCUM_bln_rub,2015</span><span class="se">\n</span><span class="s1">11,4,26922.0,GOV_CONSOLIDATED_REVENUE_ACCUM_bln_rub,2015</span><span class="se">\n</span><span class="s1">12,1,5876.1,GOV_CONSOLIDATED_REVENUE_ACCUM_bln_rub,2016</span><span class="se">\n</span><span class="s1">13,2,12521.5,GOV_CONSOLIDATED_REVENUE_ACCUM_bln_rub,2016</span><span class="se">\n</span><span class="s1">14,3,19374.5,GOV_CONSOLIDATED_REVENUE_ACCUM_bln_rub,2016</span><span class="se">\n</span><span class="s1">15,4,27746.7,GOV_CONSOLIDATED_REVENUE_ACCUM_bln_rub,2016</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">assert</span> <span class="n">dfm</span><span class="o">.</span><span class="n">to_csv</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;,month,value,varname,year</span><span class="se">\n</span><span class="s1">0,1,1591.7,GOV_CONSOLIDATED_REVENUE_ACCUM_bln_rub,2013</span><span class="se">\n</span><span class="s1">1,2,3206.6,GOV_CONSOLIDATED_REVENUE_ACCUM_bln_rub,2013</span><span class="se">\n</span><span class="s1">2,3,5401.6,GOV_CONSOLIDATED_REVENUE_ACCUM_bln_rub,2013</span><span class="se">\n</span><span class="s1">3,4,7707.7,GOV_CONSOLIDATED_REVENUE_ACCUM_bln_rub,2013</span><span class="se">\n</span><span class="s1">4,5,9441.5,GOV_CONSOLIDATED_REVENUE_ACCUM_bln_rub,2013</span><span class="se">\n</span><span class="s1">5,6,11370.7,GOV_CONSOLIDATED_REVENUE_ACCUM_bln_rub,2013</span><span class="se">\n</span><span class="s1">6,7,13574.9,GOV_CONSOLIDATED_REVENUE_ACCUM_bln_rub,2013</span><span class="se">\n</span><span class="s1">7,8,15472.1,GOV_CONSOLIDATED_REVENUE_ACCUM_bln_rub,2013</span><span class="se">\n</span><span class="s1">8,9,17417.5,GOV_CONSOLIDATED_REVENUE_ACCUM_bln_rub,2013</span><span class="se">\n</span><span class="s1">9,10,19700.9,GOV_CONSOLIDATED_REVENUE_ACCUM_bln_rub,2013</span><span class="se">\n</span><span class="s1">10,11,21570.2,GOV_CONSOLIDATED_REVENUE_ACCUM_bln_rub,2013</span><span class="se">\n</span><span class="s1">11,12,24442.7,GOV_CONSOLIDATED_REVENUE_ACCUM_bln_rub,2013</span><span class="se">\n</span><span class="s1">12,1,1726.3,GOV_CONSOLIDATED_REVENUE_ACCUM_bln_rub&#39;</span><span class="p">)</span></div>
        
<div class="viewcode-block" id="TestDatapoints.test_mixed_dataframes"><a class="viewcode-back" href="../../../kep.parser.html#kep.parser.test_datapoints.TestDatapoints.test_mixed_dataframes">[docs]</a>    <span class="k">def</span> <span class="nf">test_mixed_dataframes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Special section csv_content_3 between tables  csv_content_1 and csv_content_2</span>
<span class="sd">        </span>
<span class="sd">        csv: csv_content_1 + csv_content_3 + csv_content_2] </span>
<span class="sd">        yaml: dict(default=yaml_content_1, additional=yaml_content_2)</span>
<span class="sd">        matches: will need to recycle test values from prvios tests</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="kc">False</span></div></div>
        <span class="c1"># TODO: user interface for default and additional spec in datapoints.py</span>
        <span class="c1"># TODO: this test </span>
        
        

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>    
    <span class="n">unittest</span><span class="o">.</span><span class="n">main</span><span class="p">()</span>
    <span class="c1"># input_csv = csv_content_1 + csv_content_2</span>
    <span class="c1"># yaml_content = yaml_content_1</span>
    <span class="c1"># dfa, dfq, dfm = get_dfs(input_csv, yaml_content)</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017, Author.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.5.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.9</a>
      
    </div>

    

    
  </body>
</html>